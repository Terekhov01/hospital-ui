<div class = "scheduleTableDiv mat-elevation-z4">
    <div class = "schedulePatternInputBlock">

        <!-- TODO - make reactive too -->
        <mat-form-field class="inputPatternName" appearance="fill">
            <mat-label>Название шаблона</mat-label>
            <input matInput type="text" [(ngModel)]="newPatternName">
            
            <button *ngIf="newPatternName.length !== 0" matSuffix mat-icon-button aria-label="Clear" (click)="newPatternName=''">
                <mat-icon>close</mat-icon>
            </button>
            
        </mat-form-field>

        <form [formGroup] = "tableData.getTableDataSubject().value">

            <div class = "tableDiv">
                <ng-container formArrayName = "rows">
                    <mat-table class = "table mat-elevation-z4" [dataSource] = "tableData">

                    <!--<div *ngIf = "debugger(tableData)"></div>-->
                    <!--- Note that these columns can be defined in any order.
                        The actual rendered columns are set as a property on the row definition" -->
                        
                        <ng-container *ngFor="let columnId of tableData.getDisplayedColumns().value; let i = index;" matColumnDef = {{columnId}}>
                            <th mat-header-cell *matHeaderCellDef class = "dynamicAmountColumnHeader"> 
                                <div>День {{columnId}}</div>
                            </th>
                
                            <div>
                                <td mat-cell *matCellDef = "let element; let j = index;" [formGroupName] = "j" class = "dynamicAmountColumnContents">
                                    <div formArrayName = "cells">
                                        <div [formGroupName] = "i">
                                            <div class="startTimePicker">
                                                <input placeholder="" aria-label = "" [format] = "24" [ngxTimepicker] = "startTime" formControlName = "startTimePicker" readonly>
                                                <ngx-material-timepicker #startTime [enableKeyboardInput]="true" [minutesGap] = "30" [theme] = "primaryTheme"></ngx-material-timepicker>
                                            </div>
                    
                                            <div class="endTimePicker">
                                                <input placeholder="" aria-label = "" [format] = "24" [ngxTimepicker] = "endTime" formControlName = "endTimePicker" readonly>
                                                <ngx-material-timepicker #endTime [enableKeyboardInput]="true" [minutesGap] = "30" [theme] = "primaryTheme"></ngx-material-timepicker>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </div>
                        </ng-container>
                        
                        <tr mat-header-row *matHeaderRowDef="tableData.getDisplayedColumns().value; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: tableData.getDisplayedColumns().value;"></tr>
                    </mat-table>
                </ng-container>

                <div class = "columnButtonBlock">
                    <button mat-stroked-button color = "primary" (click) = "tableData.addColumn()">
                        <mat-icon>add</mat-icon>
                    </button>
                    <button mat-stroked-button color = "primary" (click) = "tableData.removeColumn()">
                        <mat-icon>remove</mat-icon>
                    </button>
                </div>
        
                <div class = "rowButtonBlock">
                    <button mat-stroked-button color = "primary" (click) = "tableData.addRow()">
                        <mat-icon>add</mat-icon>
                    </button>
                    <button mat-stroked-button color = "primary" (click) = "tableData.removeRow()">
                        <mat-icon>remove</mat-icon>
                    </button>
                </div>
                
                <button mat-raised-button color="primary" class = "saveButtonBlock" (click) = "onSubmitClicked()">
                    <mat-icon>save</mat-icon>
                </button>

            </div>
        </form>
    </div>
</div>

<app-apply-schedule-pattern></app-apply-schedule-pattern>