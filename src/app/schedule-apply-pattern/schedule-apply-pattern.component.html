<div class = "mat-elevation-z4 blockContents">
    <div class = "patternUsageBlock">
        <div class = "flexSpaceBetween">
            <mat-form-field class = "dropdownInputField" appearance = "fill">
                <mat-label>Название шаблона</mat-label>
                <input type = "text"
                    placeholder = "Начните печатать..."
                    aria-label = ""
                    matInput
                    [formControl] = "patternAutocompleteFormControl.getFormControl()"
                    [matAutocomplete] = "auto">
                    
                    <button *ngIf="patternAutocompleteFormControl.getFormControl().value.length !== 0" matSuffix mat-icon-button aria-label="Clear" (click)="patternAutocompleteFormControl.getFormControl().setValue('')">
                        <mat-icon>close</mat-icon>
                    </button>

                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" class = "autocompletePatternAutocomplete">
                    <!-- TODO - introduce categories of doctors by their profession -->
                    <!-- <mat-optgroup *ngFor="let group of stateGroupOptions | async" [label]="group.letter"> -->
                    <mat-option *ngFor="let patternShortInfo of patternAutocompleteFormControl.patternShortInfoFiltered" [value] = "patternShortInfo.name">
                        {{ patternShortInfo.name }}
                    </mat-option>
                </mat-autocomplete>
            </mat-form-field>

            <button mat-raised-button color = "primary" id = "deleteButton" [disabled] = "deleteButtonFormControl.disabled" (click) = "onDeleteButtonClicked()">Удалить</button>
    
        </div>

        <form [formGroup] = "tableData.getTableDataSubject().value">

            <div class = "tableDiv">
                <ng-container formArrayName = "rows">
                    <mat-table class = "scheduleTable mat-elevation-z4" [dataSource] = "tableData">

                    <!--<div *ngIf = "debugger(tableData)"></div>-->
                    <!--- Note that these columns can be defined in any order.
                        The actual rendered columns are set as a property on the row definition" -->
                        
                        <ng-container *ngFor="let columnId of tableData.getDisplayedColumns().value; let i = index;" matColumnDef = {{columnId}}>
                            <th mat-header-cell *matHeaderCellDef class = "dynamicAmountColumnHeader"> 
                                <div style = "margin-top: 13px;">День {{columnId}}</div>
                            </th>
                
                            <div>
                                <td mat-cell *matCellDef = "let element; let j = index;" [formGroupName] = "j" class = "dynamicAmountColumnContents">
                                    <div formArrayName = "cells">
                                        <div [formGroupName] = "i">
                                            <div class = "timeInterval">
                                                <input formControlName = "startTime" class = "timeField" readonly>
                                                <p style = "display: inline-block; padding: 5px;"> - </p>
                                                <input formControlName = "endTime" class = "timeField" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </div>
                        </ng-container>
                        
                        <tr mat-header-row *matHeaderRowDef="tableData.getDisplayedColumns().value; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: tableData.getDisplayedColumns().value;"></tr>
                    </mat-table>
                </ng-container>                
            </div>
        </form>

        <a class = "scheduleApplyRepeatCnt"> Количество повторений: </a>
        <input type = "number" class = "scheduleApplyRepeatCnt" name = "scheduleApplyRepeatCnt" [formControl] = "scheduleApplyRepeatFormControl" min = "1" max = "30">

        <div class = "flexSpaceBetween">
            <form [formGroup] = "patternRangePicker">
                <mat-form-field appearance = "fill" class = "dateRangePickerField">
                    <mat-label>Выберите дату</mat-label>
                    <mat-date-range-input [rangePicker]="picker">
                    <input matStartDate formControlName = "rangeStartDate" placeholder="Start date">
                    <input matEndDate formControlName = "rangeEndDate" placeholder="End date">
                    </mat-date-range-input>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-date-range-picker #picker></mat-date-range-picker>
                </mat-form-field>
            </form>

            <button mat-raised-button color = "primary" id = "changeButton" [disabled] = "changeButtonFormControl.disabled" (click) = "onProlongButtonClicked()">Изменить</button>
        </div>
    </div>

</div>